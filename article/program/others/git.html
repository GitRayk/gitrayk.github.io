<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" name="viewport" content="width=device-width; initial-scale=1">
    <!-- meta使用viewport来适配移动端浏览器 -->
    <link rel="icon" href="../../../img/icon.png">
    <link rel="stylesheet" href="../../../sheet.css" type="text/css" class="sheet">
    <link rel="stylesheet" href="../../../mobile-sheet.css" type="text/css">
    <script src="../../../skin.js"></script>
    <script src="../../../prepareBeforeStart.js"></script>
    <title>Git 教程 | 尼伯龙根</title>
</head>

<body onload="readyForRead()">
    <div class="head-title">
        <a href="../../../index.html"><img src="../../../img/icon.png" width="30" height="30" alt="icon" style="vertical-align:text-bottom;"/><span style="font-size: 20px;"> Niebelungen尼伯龙根</span></a>
        <span>
		&nbsp;&nbsp;&nbsp;<a href="../../article.html" class="hyperlink" style="border-bottom: 2px solid rgb(50, 50, 105);">贴文</a>
		&nbsp;&nbsp;&nbsp;<a href="../../../about/about.html" class="hyperlink" id="about">关于</a>
	    </span> 
        <a href="javascript:void(0);" title="更换皮肤"><img src="../../../img/sun and moon.png" alt="暗夜模式" id="shift-skin" onclick="clickSkin()" style="width: 20px; height: 20px"></a>
    </div>
    
    <div class="nav-article">
        <p>Category:</p>
        <ul>
            <div class="dropdown web">
                <li>Web开发</li>
                <div class="dropdown-content-web">
                    <ul>
                        <li><a href="../../css/css-index.html">CSS</a></li>
                        <li><a href="../../html/html-index.html">HTML</a></li>
                        <li><a href="../../javascript/index-js.html">JavaScript</a></li>
                    </ul>
                </div>
            </div>
            <div class="dropdown daily">
                <li>日常</li>
                <div class="dropdown-content-daily">
                    <ul>
                        <li><a href="../../travels/travels-index.html">游记</a></li>
                    </ul>
                </div>
            </div>
            <div class="dropdown">
                <li>编程</li>
                <div class="dropdown-content">
                    <ul>
                        <li><a href="../python/python-index.html">Python</a></li>
                        <li><a href="../c/c-index.html">C/C++</a></li>
                        <li><a href="./others-index.html">其它</a></li>
                    </ul>
                </div>
            </div>
            <div>
                <li><a href="../../unclassified/unclassified-index.html">未分类</a></li>
            </div>
        </ul>
    </div>

    <div class="article">
        <h1>Git 教程</h1><hr>
        <div class="article-text">
            <h4 class="date">2022-3-8</h4>
            <p>
                Git 是一种分布式版本控制系统，安装包下载地址： <a href="http://git-scm.com/downloads">点击跳转</a>
            </p>
            <hr>
            <h2>配置</h2>
            <p>
                Git 系统的配置文件有三种：
                <ol>
                    <li><b>/etc/gitconfig 文件</b>：系统中对所有用户都普遍适用的配置。若使用 git config 时用 --system 选项，读写的就是这个文件。</li>
                    <li><b>~/.gitconfig 文件</b>：用户目录下的配置文件只适用于该用户。若使用 git config 时用 --global 选项，读写的就是这个文件。</li>
                    <li><b>工作目录中的 .git/config 文件</b>：仅针对当前项目有效，仅使用 git config 进行配置</li>
                </ol>
                安装好 Git 后启动 Git bash 程序或 cmd。使用以下命令：<br>
                <span class="code">$ git config --global user.name "用户名"</span> 设定账户的用户名<br>
                <span class="code">$ git config --global user.email xxxx@xxxx.com</span> 设定使用的邮箱<br>
                <span class="code">$ git config --global core.editor emacs</span> 设定 Git 的默认编辑器（初始是 vi 或 vim）<br>
                <span class="code">$ git config --list</span> 查看所有已经配置的变量 <br>
                <span class="code">$ git config 变量</span> 查看特定的变量 <br>
            </p>
            <hr>
            <h2>Git 的基本使用</h2>
            <p>
                Git 的工作流程如下图所示：
                <img src="../../../img/git-process1.png" alt="Git 工作流程"><br>
                Git 的基本概念：<br>
                <b>工作区：</b>就是你在电脑里能看到的目录。<br>
                <b>暂存区：</b>英文叫 stage 或 index。一般存放在 .git 目录下的 index 文件（.git/index）中，所以我们把暂存区有时也叫作索引（index）。<br>
                <b>版本库：</b>工作区有一个隐藏目录 .git，这个不算工作区，而是 Git 的版本库（本地仓库）<br>
                它们之间的关系参考如图:<br>
                <img src="../../../img/git-process2.jpg"><br>
                这意味着开始一个项目时，对文件的修改都是在工作区完成的。<br>
                一旦完成一个阶段的工作，就可以将其通过 add 指令来把指定文件复制到暂存区当中。<br>
                若是想要保存当前时间点的快照，使用 commit 指令就可以把暂存区的所有文件复制到版本库中。版本库中会保存各个提交历史时的快照。<br>
                当想要回溯到某个版本时，可以使用 reset 指令来将快照从版本库中提取到暂存区中(也可以同时提取到工作区)<br>
                HEAD 可以理解为版本库中的一个指针，它指向当前(最新)的版本<br>
                暂时不理解也没关系，可以等到掌握了大部分内容后再回来看这段话
            </p>
            <hr>
            <h2>Git 的使用</h2>
            <p>
                Git 的工作就是创建和保存你的项目的快照及与之后的快照进行对比。
                使用 Git 只需要在命令行键入相应的命令即可<br>
                <b>初始化仓库：</b> <span class="code">git init [指定目录]</span><br>
                该命令会在指定目录下生成一个 .git 目录（版本库）。若是没有指定目录则在当前工作路径下创建，
                所有 Git 需要的数据和资源都会被放在这个目录中。<br><br>

                <b>添加文件：</b> <span class="code">git add 文件路径</span><br>
                使 Git 对指定的文件进行追踪并提交(复制)到暂存区，但此时还并没有真正添加到 Git 仓库中。<br>
                每一次文件修改后都要 add 一遍<br><br>
                
                <b>提交事务：</b> <span class="code">git commit 参数 说明</span><br>
                提交暂存区到本地仓库。可以使用参数 -m 添加 message 说明，-a 先将以前追踪过的文件复制到暂存区后再提交到版本库。<br>
                linux 中说明使用单引号，windows 下使用双引号<br><br>
                
                <b>从现有的仓库中拷贝项目：</b> <span class="code">git clone 源路径 [目的路径]</span><br>
                省略目的路径时，会自动在当前路径下创建一个与项目仓库同名的目录，并且将拷贝的所有文件放于目录中的 .git 里<br><br>

                <b>删除文件: </b> <span class="code">git rm 文件路径</span><br>
                与 rm 不同的是，<b>只有通过 git rm 删除的文件，才会在提交时把“删除”这一动作提交到版本库中，意味着当前提交的版本就不会包括被删的文件</b><br>
                而 rm 删除的文件， 在回滚到本次提交的版本后依旧会恢复，版本库无法发现工作区文件已经被删除。<br>
                但是如果在提交时同时使用 -a 参数，则 git 就会发现该文件已经从工作区中删除了，于是也将删除文件的操作提交上去<br><br>
                
                <b>查看历史提交记录：</b> <span class="code">git log</span><br>
                <b>查看仓库当前的状态，显示有变更的文件。</b> <span class="code">git status</span><br>
                <b>比较文件的不同，即暂存区和工作区的差异</b> <span class="code">git diff</span><br>
                <b>移动或重命名工作区文件</b> <span class="code">git mv</span><br>
                <b>远程仓库操作</b><span class="code">git remote</span><br>
                <b>从远程获取代码库</b><span class="code">git fetch</span><br>
                <b>下载远程代码并合并</b><span class="code">git pull</span><br>
                <b>上传远程代码并合并</b><span class="code">git push</span><br>
            </p>
            <hr>
            <h2>分支管理</h2>
            <p>
                使用分支意味着你可以从开发主线上分离开来，然后在不影响主线的同时继续工作。<br>
                当你切换分支的时候，Git 会用该分支的最后提交的快照替换你的工作目录的内容， 所以多个分支不需要多个目录。<br>

                <b>列出/创建分支：</b> <span class="code">git branch [branchname]</span><br>
                当不使用参数时为列出所有分支，否则为创建一个指定名字的分支。<br>
                其中 master 分支是在 init 初始化时就会创建的一个分支。当前所在的分支会在前面用 * 星号标记<br>
                <b>当你以此方式在上次提交更新之后创建了新分支demo，如果后来又有更新提交(在非demo分支)， 然后又切换到了 demo 分支，Git 将还原你的工作目录到你创建分支时候的样子(即这次提交之前的状态)。</b><br>
                我的理解是，保存的状态在各分支中是独立存在的，在一个分支中做的修改不影响其他分支。<br><br>

                <b>切换分支：</b> <span class="code">git checkout branchname</span><br>
                也可以通过 <span class="code">git checkout -b branchname</span> 来立即创建并进入一个分支<br>
                记得要在切换分支之前提交在当前分支做的操作，否则一些操作可能会丢失<br><br>

                <b>删除分支：</b> <span class="code">git branch -d branchname</span><br><br>

                <b>合并分支：</b> <span class="code">git merge branchname</span><br>
                该指令会将指定分支的文件合并到当前工作的分支当中。（或者说是将另一个分支的文件删除或复制过来，以保证两边的文件是一致的）<br>
                当相同的两个文件中的内容有所不同时，会产生<b>合并冲突</b>，此时当前所在分支会变为一个临时分支，
                在该分支中，产生冲突的文件中会将有冲突的部分显示出来，我们需要在这个临时分支中进行手动修改。<br>
                修改之后使用 git add 和 git merge 就可以成功合并<br>
                <b>合并的分支必须是“有值得更新的内容的”</b>，换句话说，不能将旧版本合并到新版本当中，此时会提示 <b>“Already up to date”。</b><br>
                举个例子，如果从分支A创建了新的分支B，然后在分支B中做了修改，此时B是A的新版，所以不能在分支B中使用 git merge A 来进行合并。(反过来是可以的)<br>
                但是如果A也发生了更改，那么这两个分支的版本不再有新旧关系，可以发生合并。
            </p>
            <hr>
            <h2>Git 提交历史</h2>
            <p>
                使用 <span class="code">git log</span> ，可以查看历史提交记录，列出包括提交人，提交时间和附加信息等数据<br>
                其中每个版本前的神秘数字就是用来区分不同的快照。<br>
                按下q键可退出查看状态<br>
                <table>
                    <tr><th>常用参数</th><th>效果</th></tr>
                    <tr><td>--oneline</td><td>查看简略的信息</td></tr>
                    <tr><td>--graph</td><td>显示一个简单的拓扑图，查看历史中的分支和合并情况</td></tr>
                    <tr><td>--reverse</td><td>按时间逆向显示所有日志</td></tr>
                    <tr><td>--author=</td><td>查找指定用户的提交日志</td></tr>
                    <tr><td>--until/after={}</td><td>查看指定时间的日志，也可以用 --since/before={} </td></tr>
                </table>
            </p>
            <p>
                如果要查看指定文件的修改记录可以使用 <span class="code"> git blame filename </span>
            </p>
            <hr>
            <h2>标签及回滚</h2>
            <p>
                当工程进度达到某个特殊的时间点时，可以使用<b>标签</b>来标记一个特殊的已提交快照<br>
                使用 <span class="code"> git tag -a tagname -m "标签信息"</span> 来创建这样一个标签。<br>
                此时最新一次提交的版本快照(HEAD)会被标记的。<br>
                当不使用任何参数时，将会显示所有的已使用标签。<br>
                也可以为以前提交的版本进行标记，直接在命令末尾加上要标记的快照id即可
            </p>
            <p>
                当我们想要<b>回滚</b>到某个快照时，需要使用 <span class="code">git reset</span><br>
                该命令默认携带参数 <b>--mixed</b>，用于重置暂存区的文件与某次的提交的保持一致<br>
                相当于将指定的快照恢复到暂存区中。但是需要注意的是此时<b>工作区的文件不会发生变化</b><br>
                当不指定任何版本时，会将 HEAD(HEAD~0) 指向的版本恢复。<br>
                其中 HEAD^(HEAD~1) 可以回退到上一个版本<br>
                HEAD^^(HEAD~2) 回退到上上个版本，以此类推。<br>
                可以只回滚指定的文件，直接在命令末尾加上要回滚的文件即可
            </p>
            <p>
                当 reset 使用参数 <b>--hard</b> 时，会将暂存区与工作区都回到上一次版本，并删除之前的所有信息提交。<br>
                这意味着中间这段记录若是没有保存备份，将会直接丢失
            </p>
            <hr>
            <h2>Git 远程操作</h2>
            <p>
                为了通过 Git 分享代码或与其他开发人员合作。需要将数据放到一台其他开发人员能够连接的服务器上。<br>
                常使用的服务器有 Github 和 Gitee，这里以 Github 为例
            </p>
            <p>
                先在本地生成 ssh 密钥和公钥对，然后将公钥保存在 Github的账户设置中<br>
                之后通过 ssh 连接 git@github.com 进行首次配对。Git 的远程操作就是通过 ssh 来完成的<br>
                在 Github 创建的仓库中，提供了用 ssh 连接的url，根据它并在本地使用以下命令建立远程仓库连接：<br>
                <span class="code">git remote add 仓库别名简称 url</span><br>
                完成之后，就可以用 git remote 查看当前配置有哪些远程仓库。<br>
                使用参数 <b>-v</b> 时可以同时查看到每个别名的实际链接地址。
            </p>
            <p>
                <b>要想删除远程仓库</b>，只需使用 <span class="code">git remote rm 仓库别名简称</span> 即可<br>
                该方法不会删除保存在服务器上的代码，只是相当于切断这个连接
            </p>
            <p>
                <b>提取远程仓库时</b>，要先使用 <span class="code">git fetch 远程仓库别名 [远程分支]</span> 来拉取远程代码到本地的分支当中<br>
                之后使用 <span class="code">git merge 仓库别名简称/分支 </span>将刚刚拉取到的内容合并到当前分支中。
            </p>
            <p>
                <b>需要向远程仓库更新数据时</b>，使用 <span class="code">git push [alias] [branch]</span><br>
                以上命令将你的 [branch] 分支推送成为 [alias] 远程仓库上的 [branch] 分支。
            </p>
            <hr>
            <p>
                在使用 git 的过程中文件会出现许多不同的符号，表示当前的状态：<br>
                <ul>
                    <li><b>A:</b> 你本地新增的文件（服务器上没有）.</li>
                    <li><b>C:</b> 文件的一个新拷贝.</li>
                    <li><b>D:</b> 你本地删除的文件（服务器上还在）.</li>
                    <li><b>M:</b> 文件的内容或者mode被修改了.</li>
                    <li><b>R:</b> 文件名被修改了。</li>
                    <li><b>T:</b> 文件的类型被修改了。</li>
                    <li><b>U:</b> 文件没有被合并(你需要完成合并才能进行提交)。</li>
                    <li><b>X:</b> 未知状态(很可能是遇到git的bug了，你可以向git提交bug report)。</li>
                </ul>
            </p>
        </div>
    </div>
</body>

</html>
